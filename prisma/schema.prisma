datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Filme {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  nome        String
  descricao   String
  imagemUrl   String
  genero      String
  atores      String
  sessoes     Sessao[]

  @@map("filmes")
}

model Sala {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  nome       String
  capacidade Int
  sessoes    Sessao[]

  @@map("salas")
}

model Sessao {
  id           String     @id @default(auto()) @map("_id") @db.ObjectId
  filmeId      String @db.ObjectId
  salaId       String @db.ObjectId
  horario      DateTime
  filme        Filme      @relation(fields: [filmeId], references: [id])
  sala         Sala       @relation(fields: [salaId], references: [id])
  ingressos    Ingresso[]

  @@unique([salaId, horario])

  @@map("sessoes")
}

model Ingresso {
  id            String   @id @default(auto()) @map("_id")  @db.ObjectId
  sessaoId      String @db.ObjectId
  numeroAssento Int
  sessao        Sessao   @relation(fields: [sessaoId], references: [id])

  @@unique([sessaoId, numeroAssento])

  @@map("ingressos")
}
